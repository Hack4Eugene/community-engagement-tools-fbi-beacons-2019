<!DOCTYPE html>
<html>
	<head>
		<title>FBI Beacons</title>
		<meta name="viewport" content="initial-scale=1.0">
		<meta charset="utf-8">
		<link rel="stylesheet" href="main.css">
	</head>
	<body>
		<div id="map"></div>
	</body>
	<footer>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
        <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
        <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
		<script>
			let map, pos;
	
			// For filter buttons.
			let blueClicked = false;
			let yellowClicked = false;
			let redClicked = false;
			let greenClicked = false;
			let purpleClicked = false;
			let orangeClicked = false;
			
			function CenterControl(controlDiv, map, text, title, color, colorClicked) {

		        // Set CSS for the control border.
		        let controlUI = document.createElement('div');
		        controlUI.style.backgroundColor = '#fff';
		        controlUI.style.border = '2px solid #fff';
		        controlUI.style.borderRadius = '3px';
		        controlUI.style.boxShadow = '0 2px 6px rgba(0,0,0,.3)';
		        controlUI.style.cursor = 'pointer';
		        controlUI.style.marginBottom = '22px';
		        controlUI.style.textAlign = 'center';
		        controlUI.title = title;
		        controlDiv.appendChild(controlUI);

		        // Set CSS for the control interior.
		        let controlText = document.createElement('div');
		        controlText.style.height = '30px';
		        controlText.style.width = '100px';
		        controlText.style.color = 'rgb(25,25,25)';
		        controlText.style.fontFamily = 'Roboto,Arial,sans-serif';
		        controlText.style.fontSize = '16px';
		        controlText.style.lineHeight = '38px';
		        controlText.style.paddingLeft = '5px';
		        controlText.style.paddingRight = '5px';
		        controlText.innerHTML = text;
		        controlUI.appendChild(controlText);

		        // Setup the click event listeners: change background on click.
		        controlUI.addEventListener('click', function() {
		        	if (colorClicked == true){
		        		controlUI.style.backgroundColor = '#fff';
		        		colorClicked = false;
		        	} else {
		        		controlUI.style.backgroundColor = 'rgb(211,211,211)';
		        		colorClicked = true;
		        	}

		        });

		      }
			function initMap() {
				map = new google.maps.Map(document.getElementById('map'), {
					center: {lat: 44.048, lng: -123.101},
					zoom: 15
				});
				infoWindow = new google.maps.InfoWindow;

				// Color Filter Buttons.
				let BControlDiv = document.createElement('div');
        		let BcenterControl = new CenterControl(BControlDiv, map, "Filter Blue", "Click to filter blue events", "Blue", blueClicked);
        		
        		let RControlDiv = document.createElement('div');
        		let RcenterControl = new CenterControl(RControlDiv, map, "Filter Red", "Click to filter red events", "Red", redClicked);

        		let GControlDiv = document.createElement('div');
        		let GcenterControl = new CenterControl(GControlDiv, map, "Filter Green", "Click to filter green events", "Green", redClicked);

        		let YControlDiv = document.createElement('div');
        		let YcenterControl = new CenterControl(YControlDiv, map, "Filter Yellow", "Click to filter yellow events", "Yellow", yellowClicked);

        		let PControlDiv = document.createElement('div');
        		let PcenterControl = new CenterControl(PControlDiv, map, "Filter Purple", "Click to filter purple events", "Purple", purpleClicked);

        		let OControlDiv = document.createElement('div');
        		let OcenterControl = new CenterControl(OControlDiv, map, "Filter Orange", "Click to filter orange events", "Orange", orangeClicked);
        		
        		// Add buttons to the map.
        		map.controls[google.maps.ControlPosition.RIGHT].push(BControlDiv);
        		map.controls[google.maps.ControlPosition.RIGHT].push(RControlDiv);
        		map.controls[google.maps.ControlPosition.RIGHT].push(GControlDiv);
        		map.controls[google.maps.ControlPosition.RIGHT].push(YControlDiv);
        		map.controls[google.maps.ControlPosition.RIGHT].push(PControlDiv);
        		map.controls[google.maps.ControlPosition.RIGHT].push(OControlDiv);
				
				// HTML5 geolocation.
				if (navigator.geolocation) {
					navigator.geolocation.getCurrentPosition(function(position) {
						pos = {
							lat: position.coords.latitude,
							lng: position.coords.longitude
						};

						//createInfoWindow("", )
						// infoWindow.setPosition(pos);
						// infoWindow.setContent(
						// 	"<a href='https://www.google.com' target='_blank'><strong>Name of Event</strong></a><br>" + 
						// 	"Description of Event<br><br>" +
						// 	"<center><span class='green-dot'></span></center>"

						// );
						// infoWindow.open(map);
						map.setCenter(pos);
					}, function() {
						handleLocationError(true);
					});
				} else {
				  // Browser doesn't support Geolocation
				  handleLocationError(false);
				}
			}

			function handleLocationError(browserHasGeolocation) {
				if(browserHasGeolocation){
					console.log("YES GEO LOCATION SUPPORT");
				}else{
					console.log("NO GEO LOCATION SUPPORT");
				}
			}

			function createInfoWindow(name, type, description, link, latitude, longitude, radius, color){
				// Create Infowindow
				infoWindow.setPosition(position);
				infoWindow.setContent(
					"<a href=" + link + " target='_blank'><strong>" + name + "</strong></a><br>" + 
					type + ": " + description + "<br><br>" +
					"<center><span class='" + color + "-dot'></span></center>"

				);
				infoWindow.open(map);
			}
		</script>
		<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyB24J71y174znE9qqKYw0zF35-M_KRfzwg&callback=initMap" async defer></script>
	</footer>
</html>
